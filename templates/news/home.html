{% extends "base.html" %}
{% load static %}
{% load news_tags %}  {# custom template tag for categories & featured articles #}

{% block title %}Home | News Magazine{% endblock %}

{% block content %}
<!-- Hero Carousel -->
<div id="heroCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
  <div class="carousel-inner">
    {% for article in featured_articles %}
    <div class="carousel-item {% if forloop.first %}active{% endif %}">
      {% if article.featured_image %}
      <img src="{{ article.featured_image.url }}" class="d-block w-100" alt="{{ article.title }}">
      {% endif %}
      <div class="carousel-caption d-none d-md-block">
        <span class="badge bg-danger hero-badge show">Featured</span>
        <h5>{{ article.title }}</h5>
        <p class="text-truncate">{{ article.content|striptags }}</p>
        <a href="{{ article.get_absolute_url }}" class="btn btn-primary btn-sm">Read More</a>
      </div>
    </div>
    {% endfor %}
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>

<!-- Article Grid -->
<div class="container">
  <div class="row g-4">
    {% for article in articles %}
    <div class="col-md-4">
      <div class="dark-card">
        <div class="card-img-container">
          {% if article.image %}
          <img src="{{ article.image.url }}" class="zoom-img" alt="{{ article.title }}">
          {% endif %}
        </div>
        <div class="p-3">
          <h5 class="text-white">{{ article.title }}</h5>
          <p class="text-truncate">{{ article.content|striptags }}</p>
          <a href="{{ article.get_absolute_url }}" class="btn btn-outline-primary btn-sm">Read More</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Back to Top Button -->
<button id="backToTopBtn" title="Back to Top"><i class="bi bi-arrow-up"></i></button>

<script>
  // Back-to-Top
  const backToTopBtn = document.getElementById("backToTopBtn");
  window.onscroll = () => {
    if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
      backToTopBtn.style.display = "flex";
    } else {
      backToTopBtn.style.display = "none";
    }
  };
  backToTopBtn.onclick = () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  };
</script>
{% endblock %}
